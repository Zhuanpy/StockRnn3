# 项目记忆库

## 项目基本信息
- **项目名称**: Stock_RNN 量化交易系统
- **项目类型**: 基于Flask的量化交易Web应用
- **主要技术栈**: Python, Flask, SQLAlchemy, MySQL, RNN, 量化策略
- **创建时间**: 2024年
- **当前版本**: 1.0.0

## 核心功能模块

### 1. 数据模块 (Data Module)
**现有功能**:
- 股票日线数据采集和存储
- 15分钟K线数据采集
- 1分钟K线数据采集
- 基金持仓数据采集
- 数据清洗和预处理

**技术实现**:
- 使用pytdx进行数据采集
- MySQL数据库存储
- 按年份分表存储1分钟数据
- 支持多数据库绑定

**相关文件**:
- `App/codes/MySql/` - 数据库操作
- `App/models/StockData*.py` - 数据模型
- `App/routes/download_*.py` - 数据下载路由

### 2. 策略模块 (Strategy Module)
**现有功能**:
- MACD策略实现
- 布林带策略实现
- 信号生成和解析
- 策略回测框架

**技术实现**:
- 自定义信号生成算法
- 策略参数可配置
- 支持多策略组合

**相关文件**:
- `App/codes/Signals/` - 信号生成
- `App/codes/parsers/` - 信号解析
- `App/codes/Analysis/` - 策略分析

### 3. RNN模型模块 (RNN Module)
**现有功能**:
- RNN模型创建和训练
- 模型预测功能
- 模型性能监控
- 自动重新训练

**技术实现**:
- 基于PyTorch的RNN实现
- 支持LSTM和GRU
- 模型持久化存储
- 性能指标监控

**相关文件**:
- `App/codes/RnnModel/` - RNN模型相关
- `App/models/RnnModel.py` - RNN模型数据模型

### 4. 交易模块 (Trade Module)
**现有功能**:
- 模拟交易执行
- 交易信号处理
- 持仓管理
- 风险控制

**技术实现**:
- 基于策略信号的交易执行
- 支持买入/卖出操作
- 交易记录存储

**相关文件**:
- `App/codes/AutoTrade/` - 自动交易
- `App/routes/trading_*.py` - 交易路由

### 5. 评估模块 (Evaluation Module)
**现有功能**:
- 策略绩效评估
- 风险指标计算
- 回测结果分析
- 图表生成

**技术实现**:
- 收益率计算
- 最大回撤分析
- 夏普比率计算
- ECharts图表展示

**相关文件**:
- `App/codes/Evaluation/` - 评估相关
- `App/static/js/` - 前端图表

## 数据库设计

### 主要数据表
1. **stock_data_daily** - 日线数据
2. **stock_data_15m** - 15分钟数据
3. **stock_data_1m** - 1分钟数据（按年分表）
4. **funds_awkward** - 基金持仓数据
5. **rnn_models** - RNN模型信息
6. **trading_records** - 交易记录
7. **strategy_signals** - 策略信号

### 数据库配置
- 主数据库: mystockrecord
- 数据数据库: datadaily, data1m2024, data1m2025
- 基金数据库: funds_awkward

## 配置信息

### 环境变量
- `DB_HOST` - 数据库主机
- `DB_USER` - 数据库用户名
- `DB_PASSWORD` - 数据库密码
- `SECRET_KEY` - Flask密钥

### 文件路径
- 项目根目录: 自动检测
- 代码数据目录: `App/codes/code_data/`
- 密码文件目录: `App/codes/code_data/password/`
- 模型文件目录: `App/codes/RnnModel/`

## 重要决策记录

### 1. 架构决策
- **选择Flask框架**: 轻量级、灵活、适合快速开发
- **使用Blueprint**: 模块化路由管理
- **SQLAlchemy ORM**: 数据库操作抽象化
- **多数据库绑定**: 支持不同数据类型的分离存储

### 2. 技术选型
- **数据采集**: pytdx (通达信数据接口)
- **机器学习**: PyTorch (RNN模型)
- **前端图表**: ECharts (交互式图表)
- **任务调度**: APScheduler (定时任务)

### 3. 数据存储决策
- **1分钟数据分表**: 按年份分表存储，提高查询效率
- **JSON格式存储**: 复杂数据结构使用JSON字段
- **索引优化**: 对常用查询字段建立索引

### 4. 安全决策
- **密码文件分离**: 敏感信息存储在独立文件中
- **环境变量配置**: 生产环境使用环境变量
- **访问控制**: 基于角色的访问控制

## 已知问题和解决方案

### 1. 数据更新问题
**问题**: 数据更新可能失败
**解决方案**: 实现重试机制和错误日志记录

### 2. 模型训练时间
**问题**: RNN模型训练时间较长
**解决方案**: 异步训练和进度监控

### 3. 内存使用
**问题**: 大量数据处理时内存占用高
**解决方案**: 分批处理和内存优化

## 未来规划

### 短期目标 (1-3个月)
1. 完善服务层架构
2. 添加任务调度系统
3. 优化前端界面
4. 增加更多技术指标

### 中期目标 (3-6个月)
1. 实盘交易接口
2. 多策略组合优化
3. 风险管理系统
4. 性能监控系统

### 长期目标 (6-12个月)
1. 分布式架构
2. 机器学习模型优化
3. 移动端应用
4. 云服务部署

## 维护记录

### 版本更新记录
- **v1.0.0**: 基础功能实现
- **v1.1.0**: 添加RNN模型
- **v1.2.0**: 优化数据采集
- **v1.3.0**: 添加评估模块

### 重要修复记录
- 数据库连接池优化
- 内存泄漏修复
- 数据同步问题解决
- 模型训练稳定性提升

## 开发团队信息
- **主要开发者**: [开发者信息]
- **技术支持**: [技术支持信息]
- **文档维护**: [文档维护者]

## 联系方式
- **项目仓库**: [Git仓库地址]
- **问题反馈**: [反馈渠道]
- **技术支持**: [技术支持邮箱] 